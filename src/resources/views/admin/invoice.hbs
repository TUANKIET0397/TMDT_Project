{{#contentFor "styleadmin"}}
    <link rel="stylesheet" href="/css/invoice.css" />
{{/contentFor}}

<div class="main-content">
    <section class="section__status">
        <!-- Header -->
        <div class="section__inner-heading">
            <div
                style="display: flex; align-items: center; gap: 15px; width: 100%;"
            >
                <h1 class="section__heading">Orders Status</h1>
                <select
                    id="sort-status"
                    style="padding: 8px 12px; border: 1px solid currentColor; border-radius: 4px; cursor: pointer; font-size: 14px; background: #0a1330; color: #ffffffc0;"
                >
                    <option value="">Sort by Status</option>
                    <option value="Prepare">Prepare</option>
                    <option value="Done">Done</option>
                    <option value="Delivered">Delivered</option>
                    <option value="Cancelled">Cancelled</option>
                </select>
            </div>

            <div class="section__headeing-wrap--small">
                <div class="section__data">
                    <div class="section__data-wrap">
                        <i class="fas fa-glass-whiskey"></i>
                        <div class="section-date">
                            {{#if stats}}
                                Total:
                                {{stats.TotalInvoices}}
                                orders
                            {{/if}}

                        </div>
                    </div>
                </div>
                <button
                    id="delete-all-btn"
                    type="button"
                    class="section-item section-icon__trash"
                    title="Delete selected orders or all"
                    style="background: none; border: none; cursor: pointer; color: inherit;"
                >
                    <i class="fa-solid fa-trash"></i>
                </button>
            </div>

        </div>

        <!-- Header Labels -->
        <div class="section__inner-label--other">
            <div class="section-item">
                <label class="section-item__title">Order</label>
            </div>
            <div class="section-item">
                <i class="fa-solid fa-user"></i>
                <label class="section-item__title">Client</label>
            </div>
            <div class="section-item">
                <i class="fa-solid fa-calendar"></i>
                <label class="section-item__title">Date</label>
            </div>
            <div class="section-item">
                <i class="fa-solid fa-square-check"></i>
                <label class="section-item__title">Status</label>
            </div>

            <div class="section-item">
                <i class="fa-solid fa-credit-card"></i>
                <label class="section-item__title">Payment</label>
            </div>

            <div class="section-item">
                <i class="fa-solid fa-location-dot"></i>
                <label class="section-item__title">Country</label>
            </div>
            <div class="section-item">
                <label class="section-item__title">Total</label>
            </div>
            <div class="section-item">
                <label class="section-item__title">Products</label>
            </div>
            <div class="section-item">
                <label class="section-item__title">Action</label>
            </div>
        </div>

        <!-- Danh sách đơn hàng -->
        {{#each invoices}}
            <div class="section__inner-label">
                <!-- Order ID -->
                <div class="section-item">
                    <label
                        for="section-checkbox-{{this.InvoiceID}}"
                        class="section__custom-checkbox"
                    >
                        <input
                            type="checkbox"
                            id="section-checkbox-{{this.InvoiceID}}"
                            class="section-checkbox"
                            name="status"
                            value="{{this.InvoiceID}}"
                        />
                        <span
                            class="section-checkmark section-item__title"
                        >#{{this.InvoiceID}}</span>
                    </label>
                </div>

                <!-- Client Info -->
                <div class="section-item section__info-wrap">
                    <p
                        class="section__info-name section-item__title clamp-text"
                        style="--line-content:1;"
                    >
                        {{this.FirstName}}
                        {{this.LastName}}
                    </p>
                    <p
                        class="section__info-mail section-item__title clamp-text"
                        style="--line-content:1;"
                    >
                        {{this.Email}}
                    </p>
                </div>

                <!-- Date -->
                <div class="section-item">
                    <p class="section-item__date section-item__title">
                        {{formatDate this.DateCreated}}
                    </p>
                </div>

                <!-- Status -->
                <div class="section-item">
                    <div class="section-item__title">
                        {{this.InvoiceStatus}}
                    </div>
                </div>

                <!-- Payment Status (Paid/Unpaid) -->
                <div class="section-item">
                    <div class="section-item__title" style="color: {{#if (eq this.InvoicePayment 'Paid')}}#28a745{{else}}#ffc107{{/if}}; font-weight: 600;">
                        {{this.InvoicePayment}}
                    </div>
                </div>

                <!-- Country -->
                <div class="section-item">
                    <p class="section-item__location section-item__title">
                        {{#if this.Region}}{{this.Region}}{{else}}N/A{{/if}}
                    </p>
                </div>

                <!-- Total -->
                <div class="section-item">
                    <div class="section-item__total section-item__title">
                        $
                        {{formatPrice this.TotalAmount}}
                    </div>
                </div>

                <!-- Products -->
                <div class="section-item section-item__wrap">
                    {{#if this.Products}}
                        {{#each this.Products}}
                            <p
                                class="section-item__title clamp-text-other"
                                style="--line-content:1;"
                            >
                                {{this.ProductName}}
                                (x{{this.Volume}})
                            </p>
                        {{/each}}
                    {{else}}
                        <p class="section-item__title">No products</p>
                    {{/if}}
                </div>

                <!-- Delete Form - DÙNG POST -->
                <div class="section-item section-icon__trash">
                    <form
                        method="POST"
                        action="/admin/invoice/{{this.InvoiceID}}/delete"
                        style="display: inline;"
                        onsubmit="return confirm('Are you sure you want to delete order #{{this.InvoiceID}}?')"
                    >
                        <button
                            type="submit"
                            style="background: none; border: none; cursor: pointer; color: #dc3545; padding: 0;"
                        >
                            <i class="fa-solid fa-trash"></i>
                        </button>
                    </form>
                </div>
            </div>
        {{/each}}

        {{#unless invoices}}
            <div class="section__inner-label">
                <p
                    style="text-align: center; padding: 20px; grid-column: 1 / -1;"
                >No orders found</p>
            </div>
        {{/unless}}
    </section>
</div>

{{#contentFor "scriptAdmin"}}
    <script src="/js/scriptAdmin.js"></script>
{{/contentFor}}